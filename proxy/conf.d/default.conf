# Redireciona HTTP para HTTPS
server {
    listen 80;
    server_name pipa.com.br www.pipa.com.br genipabu.com.br www.genipabu.com.br pontanegra.br www.pontanegra.br webmail.pipa.com.br webmail.genipabu.com.br webmail.pontanegra.br;
    return 301 https://$host$request_uri;
}

server {
    listen 443 ssl;
    server_name web1.pipa.com.br;

    ssl_certificate /etc/nginx/ssl/pipa.cert.pem;
    ssl_certificate_key /etc/nginx/ssl/pipa.key.pem;

    location / {
        proxy_pass http://wordpress1:80;  # Alterado para o novo serviço
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

# Servidor para web2.pipa.com.br (WordPress 2)
server {
    listen 443 ssl;
    server_name web2.pipa.com.br;

    ssl_certificate /etc/nginx/ssl/pipa.cert.pem;  # Mesmo certificado se for wildcard
    ssl_certificate_key /etc/nginx/ssl/pipa.key.pem;

    location / {
        proxy_pass http://wordpress2:80;  # Segundo serviço WordPress
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}


# Servidor para genipabu.com.br (WordPress)
server {
    listen 443 ssl;
    server_name genipabu.com.br www.genipabu.com.br;

    ssl_certificate /etc/nginx/ssl/genipabu.cert.pem;
    ssl_certificate_key /etc/nginx/ssl/genipabu.key.pem;

    location / {
        proxy_pass http://wordpress:80;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

# Servidor para pontanegra.br (WordPress)
server {
    listen 443 ssl;
    server_name pontanegra.br www.pontanegra.br;

    ssl_certificate /etc/nginx/ssl/pontanegra.cert.pem;
    ssl_certificate_key /etc/nginx/ssl/pontanegra.key.pem;

    location / {
        proxy_pass http://wordpress:80;  
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    } 
}

# Servidor para Webmail (Roundcube)
server {
    listen 443 ssl;
    server_name mail.pipa.com.br mail.genipabu.com.br bmail.pontanegra.br;

   # ssl_certificate  /etc/dovecot/private/dovecot.pem;
   # ssl_certificate_key /etc/dovecot/private/dovecot.key;

    location / {
        proxy_pass http://roundcube:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
}

